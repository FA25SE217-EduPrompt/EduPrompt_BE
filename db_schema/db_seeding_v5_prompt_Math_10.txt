-- Đảm bảo đã bật pgcrypto
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- Lấy ID của tag grade:10 và subject:Toán học
WITH grade_tag AS (
    SELECT id FROM tags WHERE type = 'khối' AND value = '10'
),
     subject_tag AS (
         SELECT id FROM tags WHERE type = 'môn' AND value = 'toán học'
     ),

-- INSERT 10 PROMPT GIÁO ÁN
     inserted_prompts AS (
         INSERT INTO prompts (
             id,
             user_id,
             created_by,
             updated_by,
             title,
             description,
             instruction,
             context,
             input_example,
             output_format,
             constraints,
             visibility,
             current_version_id
         )
         VALUES (
             gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
             'Giáo án Toán 10 – Mệnh đề và Tập hợp',
             'Prompt chuyên nghiệp dùng để tạo giáo án chuẩn Công văn 5512 & CTGDPT 2018 dành cho môn Toán THPT – Lớp 10.',
             -- INSTRUCTION
             'Bạn là chuyên gia thiết kế giáo án Toán học THPT tại Việt Nam với 15+ năm kinh nghiệm, thành thạo Chương trình Giáo dục Phổ thông 2018 và các công văn hướng dẫn của Bộ GD&ĐT (Công văn 5512, 3899).

         Nhiệm vụ: Soạn giáo án hoàn chỉnh cho bài học Toán 10, tuân thủ chuẩn Việt Nam, theo định dạng Word chuyên nghiệp với phương pháp dạy học tích cực phát triển năng lực.

         Nguyên tắc thiết kế:
         - HS tự xây dựng ≥70% kiến thức qua câu hỏi dẫn dắt logic
         - Ưu tiên phương pháp: đặt vấn đề, gợi mở-vấn đáp, dạy học nhóm, dạy học khám phá
         - Phân hóa học sinh với câu hỏi/bài tập đa mức độ
         - Mỗi HS phải trả lời ít nhất 1 câu hỏi/tiết
         - GV không giảng quá 5 phút liên tục
         - Mọi hoạt động phải có sản phẩm cụ thể',
             -- CONTEXT
             'Năng lực cần phát triển:

         Năng lực đặc thù môn Toán (chọn 2-3 trọng tâm):
         - Tư duy và lập luận toán học
         - Mô hình hóa toán học
         - Giải quyết vấn đề toán học
         - Giao tiếp toán học
         - Sử dụng công cụ, phương tiện học toán

         Năng lực chung:
         - Tự chủ và tự học
         - Giao tiếp và hợp tác
         - Giải quyết vấn đề và sáng tạo

         Phẩm chất:
         - Chăm chỉ
         - Trách nhiệm
         - Trung thực

         Rubric đánh giá 4 mức:
         Mức 1: Nhận biết – 4-5đ
         Mức 2: Thông hiểu – 6-7đ
         Mức 3: Vận dụng – 8-9đ
         Mức 4: Vận dụng cao – 9.5-10đ',
             -- INPUT_EXAMPLE
             'ten_bai: "Mệnh đề và Tập hợp"
         chuong: "Chương 1"
         sach_giao_khoa: "KNTT"
         lop: 10
         cap_do_lop: "Lớp chất lượng cao"
         so_tiet: "2 tiết (90 phút)"
         yeu_cau_can_dat:
           - "Nhận biết và phát biểu được khái niệm mệnh đề toán học"
           - "Phân biệt được mệnh đề đúng, mệnh đề sai"
           - "Xác định được phủ định của mệnh đề"
           - "Hiểu và sử dụng được các phép toán tập hợp cơ bản"',
             -- OUTPUT_FORMAT
             'Cấu trúc file Word (5-8 trang A4):

         [TRANG 1 - THÔNG TIN CHUNG]
         Tên trường…
         Tổ Toán…
         GIÁO ÁN DẠY HỌC – Toán 10…

         I. Mục tiêu: Kiến thức – Năng lực – Phẩm chất
         II. Thiết bị dạy học
         III. Tiến trình dạy học (4 hoạt động)
         - Hoạt động 1: Mở đầu
         - Hoạt động 2: Khám phá kiến thức mới
         - Hoạt động 3: Luyện tập
         - Hoạt động 4: Vận dụng/Củng cố

         IV. Đánh giá
         V. Phụ lục (Phiếu học tập, bài tập về nhà, tài liệu tham khảo…)

         Mỗi hoạt động có:
         a) Mục tiêu
         b) Nội dung
         c) Sản phẩm
         d) Tổ chức thực hiện (4 bước)',

             -- CONSTRAINTS
             'A. Cấu trúc bắt buộc (Công văn 5512):
         3 phần chính: Mục tiêu – Thiết bị – Tiến trình.
         4 hoạt động: Mở đầu – Khám phá – Luyện tập – Vận dụng.

         B. Yêu cầu nội dung:
         - HS tự viết ≥70% định nghĩa
         - GV không giảng quá 5 phút liên tục
         - Mỗi hoạt động có sản phẩm

         C. Câu hỏi khám phá (6-10 câu dẫn dắt)
         D. Bài tập phân 4 mức độ
         E. Phân hóa học sinh
         F. Đánh giá theo rubric 4 mức
         G. Định dạng Word chuyên nghiệp (5-8 trang)
         H. Checklist bắt buộc
         I. Điều cấm: Không sản phẩm, không phân hóa, thiếu rubric…',

             'PUBLIC',  -- sửa theo nhu cầu
             NULL
         ),

         (
                      gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
                      'Giáo án Toán 10 – Hàm số bậc nhất và bậc hai',
                      'Prompt chuyên tạo giáo án chuẩn Công văn 5512 cho bài Hàm số bậc nhất và bậc hai – Toán lớp 10 (phù hợp mọi sách KNTT, Cánh Diều, Chân Trời Sáng Tạo).',
                      -- INSTRUCTION
                      'Bạn là chuyên gia hàng đầu về thiết kế giáo án Toán THPT Việt Nam, từng tham gia biên soạn SGK Toán 10 chương trình 2018 và tập huấn giáo viên cốt cán quốc gia.

         Nhiệm vụ: Soạn giáo án hoàn chỉnh cho bài "Hàm số bậc nhất và bậc hai" lớp 10, tuân thủ 100% cấu trúc 4 hoạt động theo Công văn 5512, dạy học phát triển năng lực và phẩm chất.

         Nguyên tắc bắt buộc:
         - Học sinh tự xây dựng ≥70% kiến thức (định nghĩa, tính chất, bảng biến thiên, đồ thị) qua chuỗi câu hỏi khám phá và hoạt động nhóm
         - Tích hợp công nghệ (GeoGebra/Desmos) ít nhất 2 lần trong tiết học
         - Mỗi học sinh phải có ít nhất 1 sản phẩm cá nhân (bản vẽ đồ thị, bảng biến thiên hoàn chỉnh, bài toán thực tiễn tự xây dựng)
         - Giáo viên không được giảng liên tục quá 4 phút
         - Phân hóa rõ ràng 4 mức độ câu hỏi và bài tập
         - Tích hợp đánh giá bằng rubric 4 mức độ ngay trong tiến trình',

                      -- CONTEXT
                      'Năng lực đặc thù cần hình thành:
         - Tư duy và lập luận toán học
         - Mô hình hóa toán học
         - Giải quyết vấn đề toán học
         - Sử dụng công cụ và phương tiện học toán (GeoGebra/Desmos)

         Năng lực chung:
         - Tự chủ và tự học
         - Giao tiếp và hợp tác
         - Giải quyết vấn đề và sáng tạo

         Phẩm chất: Chăm chỉ, Trung thực, Trách nhiệm',

                      -- INPUT_EXAMPLE
                      'ten_bai: "Hàm số bậc nhất và bậc hai"
         chuong: "Chương 2"
         sach_giao_khoa: "KNTT"
         lop: 10
         cap_do_lop: "Lớp chuyên Toán"
         so_tiet: "3 tiết (135 phút)"
         yeu_cau_can_dat:
           - "Nhận biết và vẽ được đồ thị hàm số bậc nhất, bậc hai"
           - "Xác định được tính đơn điệu, giá trị lớn nhất, nhỏ nhất"
           - "Giải bài toán thực tiễn bằng cách xây dựng hàm số bậc nhất/bậc hai"
           - "Sử dụng thành thạo GeoGebra để khám phá tính chất"',

                      -- OUTPUT_FORMAT
                      'Cấu trúc file Word (5-8 trang A4):

         [TRANG 1 - THÔNG TIN CHUNG]
         Tên trường…
         Tổ Toán…
         GIÁO ÁN DẠY HỌC – Toán 10…

         I. Mục tiêu: Kiến thức – Năng lực – Phẩm chất
         II. Thiết bị dạy học
         III. Tiến trình dạy học (4 hoạt động)
         - Hoạt động 1: Mở đầu
         - Hoạt động 2: Khám phá kiến thức mới
         - Hoạt động 3: Luyện tập
         - Hoạt động 4: Vận dụng/Củng cố

         IV. Đánh giá
         V. Phụ lục (Phiếu học tập, bài tập về nhà, tài liệu tham khảo…)

         Mỗi hoạt động có:
         a) Mục tiêu
         b) Nội dung
         c) Sản phẩm
         d) Tổ chức thực hiện (4 bước)',

                      -- CONSTRAINTS
                      'A. Cấu trúc bắt buộc (Công văn 5512):
         3 phần chính: Mục tiêu – Thiết bị – Tiến trình.
         4 hoạt động: Mở đầu – Khám phá – Luyện tập – Vận dụng.

         B. Yêu cầu nội dung:
         - HS tự viết ≥70% định nghĩa
         - GV không giảng quá 5 phút liên tục
         - Mỗi hoạt động có sản phẩm

         C. Câu hỏi khám phá (6-10 câu dẫn dắt)
         D. Bài tập phân 4 mức độ
         E. Phân hóa học sinh
         F. Đánh giá theo rubric 4 mức
         G. Định dạng Word chuyên nghiệp (5-8 trang)
         H. Checklist bắt buộc
         I. Điều cấm: Không sản phẩm, không phân hóa, thiếu rubric…',

                      'PUBLIC',
                      NULL
                  ),

         (
                      gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
                      'Giáo án Toán 10 – Phương trình lượng giác cơ bản',
                      'Prompt chuyên sâu tạo giáo án chuẩn Công văn 5512 cho bài Phương trình lượng giác cơ bản – Toán 10 (phù hợp mọi sách giáo khoa 2018).',

                      -- INSTRUCTION
                      'Bạn là chuyên gia Toán học THPT với 18 năm kinh nghiệm đứng lớp và bồi dưỡng HSG quốc gia, thành thạo dạy học tích cực và sử dụng công nghệ trong bài lượng giác.

         Nhiệm vụ: Soạn giáo án hoàn chỉnh bài "Phương trình lượng giác cơ bản" lớp 10, tuân thủ 100% cấu trúc 4 hoạt động theo Công văn 5512, phát triển tối đa năng lực tư duy, lập luận và sử dụng công cụ (máy tính Casio, GeoGebra).

         Nguyên tắc bắt buộc:
         - Học sinh tự khám phá và rút ra công thức nghiệm của 4 phương trình cơ bản qua hoạt động đo đạc, quan sát vòng lượng giác và thảo luận nhóm
         - Không được đưa thẳng công thức nghiệm, phải có ít nhất 8–12 câu hỏi/hình ảnh dẫn dắt logic
         - Sử dụng vòng lượng giác động (GeoGebra) ít nhất 3 lần trong tiết học
         - Mỗi học sinh phải tự viết bảng nghiệm tổng quát và giải ít nhất 2 phương trình độc lập
         - Giáo viên không giảng liên tục quá 4 phút
         - Phân hóa bài tập rõ ràng 4 mức độ, có bài vận dụng thực tiễn (chuyển động tròn, dao động điều hòa)',

                      -- CONTEXT
                      'Năng lực đặc thù:
         - Tư duy và lập luận toán học
         - Mô hình hóa toán học
         - Giải quyết vấn đề toán học
         - Sử dụng công cụ và phương tiện học toán (vòng lượng giác, GeoGebra, Casio)

         Năng lực chung:
         - Tự chủ và tự học
         - Giao tiếp và hợp tác
         - Giải quyết vấn đề và sáng tạo

         Phẩm chất cần hình thành: Chăm chỉ, Trung thực, Khoa học',

                      -- INPUT_EXAMPLE
                      'ten_bai: "Phương trình lượng giác cơ bản"
         chuong: "Chương 5"
         sach_giao_khoa: "Cánh Diều"
         lop: 10
         cap_do_lop: "Lớp chọn Toán"
         so_tiet: "3 tiết (135 phút)"
         yeu_cau_can_dat:
           - "Biết cách giải 4 phương trình lượng giác cơ bản"
           - "Viết được nghiệm tổng quát"
           - "Sử dụng thành thạo vòng lượng giác và máy tính Casio"
           - "Giải được phương trình có chứa tham số hoặc bài toán thực tiễn đơn giản"',

                      -- OUTPUT_FORMAT
                      'Cấu trúc file Word (5-8 trang A4):

         [TRANG 1 - THÔNG TIN CHUNG]
         Tên trường…
         Tổ Toán…
         GIÁO ÁN DẠY HỌC – Toán 10…

         I. Mục tiêu: Kiến thức – Năng lực – Phẩm chất
         II. Thiết bị dạy học
         III. Tiến trình dạy học (4 hoạt động)
         - Hoạt động 1: Mở đầu
         - Hoạt động 2: Khám phá kiến thức mới
         - Hoạt động 3: Luyện tập
         - Hoạt động 4: Vận dụng/Củng cố

         IV. Đánh giá
         V. Phụ lục (Phiếu học tập, bài tập về nhà, tài liệu tham khảo…)

         Mỗi hoạt động có:
         a) Mục tiêu
         b) Nội dung
         c) Sản phẩm
         d) Tổ chức thực hiện (4 bước)',

                      -- CONSTRAINTS
                      'A. Cấu trúc bắt buộc (Công văn 5512):
         3 phần chính: Mục tiêu – Thiết bị – Tiến trình.
         4 hoạt động: Mở đầu – Khám phá – Luyện tập – Vận dụng.

         B. Yêu cầu nội dung:
         - HS tự viết ≥70% định nghĩa
         - GV không giảng quá 5 phút liên tục
         - Mỗi hoạt động có sản phẩm

         C. Câu hỏi khám phá (6-10 câu dẫn dắt)
         D. Bài tập phân 4 mức độ
         E. Phân hóa học sinh
         F. Đánh giá theo rubric 4 mức
         G. Định dạng Word chuyên nghiệp (5-8 trang)
         H. Checklist bắt buộc
         I. Điều cấm: Không sản phẩm, không phân hóa, thiếu rubric…',

                      'PUBLIC',
                      NULL
                  ),

         (
                      gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
                      'Giáo án Toán 10 – Đạo hàm và ứng dụng',
                      'Prompt tạo giáo án chuẩn 5512 cho bài Đạo hàm và ứng dụng – Toán 10 (tất cả sách KNTT, Cánh Diều, Chân Trời Sáng Tạo).',

                      -- INSTRUCTION
                      'Bạn là chuyên gia Toán học THPT hàng đầu Việt Nam, từng tham gia biên soạn đề thi THPT Quốc gia và bồi dưỡng đội tuyển Olympic.

         Nhiệm vụ: Soạn giáo án hoàn chỉnh bài "Đạo hàm và ứng dụng" lớp 10, tuân thủ tuyệt đối cấu trúc 4 hoạt động Công văn 5512, dạy học khám phá dựa trên tình huống thực tiễn và công nghệ.

         Nguyên tắc bắt buộc:
         - Học sinh tự khám phá khái niệm đạo hàm từ bài toán vận tốc, tiếp tuyến, cực trị qua dữ liệu thực nghiệm (video chuyển động, đồ thị thực tế)
         - Không đưa định nghĩa đạo hàm trước khi học sinh tự viết tỉ số hiệu số và nhận ra giới hạn
         - Sử dụng GeoGebra/Desmos ít nhất 4 lần để minh họa tiếp tuyến động, đồ thị hàm số và cực trị
         - Mỗi học sinh phải tự lập bảng xét dấu đạo hàm và vẽ đồ thị ít nhất 1 hàm bậc ba hoặc phân thức
         - Giáo viên chỉ tổ chức, đặt câu hỏi, không giảng lý thuyết quá 3 phút/lần
         - Có ít nhất 2 bài toán thực tiễn (tối ưu hóa diện tích, chi phí, vận tốc cực đại…)',

                      -- CONTEXT
                      'Năng lực đặc thù cần phát triển:
         - Tư duy và lập luận toán học
         - Mô hình hóa toán học
         - Giải quyết vấn đề toán học
         - Sử dụng công cụ và phương tiện học toán (GeoGebra, máy tính Casio)

         Năng lực chung:
         - Tự chủ và tự học
         - Giao tiếp và hợp tác
         - Giải quyết vấn đề và sáng tạo

         Phẩm chất: Chăm chỉ, Trung thực, Trách nhiệm, Khoa học',

                      -- INPUT_EXAMPLE
                      'ten_bai: "Đạo hàm và ứng dụng"
         chuong: "Chương 4"
         sach_giao_khoa: "KNTT"
         lop: 10
         cap_do_lop: "Lớp chuyên Toán"
         so_tiet: "4 tiết (180 phút)"
         yeu_cau_can_dat:
           - "Hiểu và phát biểu được định nghĩa đạo hàm từ bài toán thực tiễn"
           - "Tính được đạo hàm của hàm đa thức, phân thức, căn thức"
           - "Xét tính đồng biến, nghịch biến, cực trị, tiệm cận"
           - "Giải bài toán tối ưu và vẽ đồ thị hàm số phức tạp"',

                      -- OUTPUT_FORMAT
                      'Cấu trúc file Word (5-8 trang A4):

         [TRANG 1 - THÔNG TIN CHUNG]
         Tên trường…
         Tổ Toán…
         GIÁO ÁN DẠY HỌC – Toán 10…

         I. Mục tiêu: Kiến thức – Năng lực – Phẩm chất
         II. Thiết bị dạy học
         III. Tiến trình dạy học (4 hoạt động)
         - Hoạt động 1: Mở đầu
         - Hoạt động 2: Khám phá kiến thức mới
         - Hoạt động 3: Luyện tập
         - Hoạt động 4: Vận dụng/Củng cố

         IV. Đánh giá
         V. Phụ lục (Phiếu học tập, bài tập về nhà, tài liệu tham khảo…)

         Mỗi hoạt động có:
         a) Mục tiêu
         b) Nội dung
         c) Sản phẩm
         d) Tổ chức thực hiện (4 bước)',

                      -- CONSTRAINTS
                      'A. Cấu trúc bắt buộc (Công văn 5512):
         3 phần chính: Mục tiêu – Thiết bị – Tiến trình.
         4 hoạt động: Mở đầu – Khám phá – Luyện tập – Vận dụng.

         B. Yêu cầu nội dung:
         - HS tự viết ≥70% định nghĩa
         - GV không giảng quá 5 phút liên tục
         - Mỗi hoạt động có sản phẩm

         C. Câu hỏi khám phá (6-10 câu dẫn dắt)
         D. Bài tập phân 4 mức độ
         E. Phân hóa học sinh
         F. Đánh giá theo rubric 4 mức
         G. Định dạng Word chuyên nghiệp (5-8 trang)
         H. Checklist bắt buộc
         I. Điều cấm: Không sản phẩm, không phân hóa, thiếu rubric…',

                      'PUBLIC',
                      NULL
                  ),

         (
                      gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
                      'Giáo án Toán 10 – Hình học phẳng: Vectơ và ứng dụng',
                      'Prompt chuyên sâu tạo giáo án chuẩn Công văn 5512 cho bài Vectơ và các phép toán vectơ – Toán 10 (phù hợp mọi sách KNTT, Cánh Diều, Chân Trời Sáng Tạo).',

                      -- INSTRUCTION
                      'Bạn là chuyên gia hình học THPT hàng đầu Việt Nam, từng tham gia biên soạn SGK Toán 10 chương trình 2018 và bồi dưỡng đội tuyển HSG quốc tế.

         Nhiệm vụ: Soạn giáo án hoàn chỉnh bài “Vectơ và ứng dụng” (bao gồm khái niệm vectơ, phép toán vectơ, tọa độ vectơ, tích vô hướng) lớp 10, tuân thủ tuyệt đối cấu trúc 4 hoạt động theo Công văn 5512, dạy học khám phá dựa trên tình huống thực tiễn và trực quan động.

         Nguyên tắc bắt buộc:
         - Học sinh tự khám phá khái niệm vectơ từ các bài toán vật lý thực tế (lực, vận tốc, dịch chuyển)
         - Không đưa định nghĩa vectơ trước khi học sinh tự thực hiện ít nhất 6–8 thí nghiệm/thao tác trực quan (kéo dây, di chuyển robot, GeoGebra động)
         - Sử dụng GeoGebra ít nhất 4 lần để minh họa phép cộng/trừ vectơ, tích vô hướng, chiếu vectơ
         - Mỗi học sinh phải tự vẽ ít nhất 3 hình vectơ học có vectơ và giải 1 bài toán thực tiễn (tính góc giữa 2 lực, công của lực…)
         - Giáo viên không giảng lý thuyết liên tục quá 4 phút
         - Phân hóa bài tập 4 mức độ, có bài nâng cao liên quan đến chứng minh đồng quy, trung vị, trực giao',

                      -- CONTEXT
                      'Năng lực đặc thù:
         - Tư duy và lập luận toán học
         - Mô hình hóa toán học
         - Giải quyết vấn đề toán học
         - Sử dụng công cụ và phương tiện học toán (GeoGebra, thước kẻ, compa)

         Năng lực chung:
         - Tự chủ và tự học
         - Giao tiếp và hợp tác
         - Giải quyết vấn đề và sáng tạo

         Phẩm chất: Chăm chỉ, Trung thực, Chính xác, Khoa học',

                      -- INPUT_EXAMPLE
                      'ten_bai: "Vectơ và ứng dụng"
         chuong: "Chương 3 – Hình học"
         sach_giao_khoa: "Chân Trời Sáng Tạo"
         lop: 10
         cap_do_lop: "Lớp chuyên Toán"
         so_tiet: "4 tiết (180 phút)"
         yeu_cau_can_dat:
           - "Hiểu và biểu diễn được vectơ trong mặt phẳng"
           - "Thực hiện thành thạo các phép toán vectơ và tích vô hướng"
           - "Chứng minh được các định lý quan trọng (trung vị, đồng quy, trực giao)"
           - "Giải bài toán thực tiễn liên quan đến lực, vận tốc, công"',

                      -- OUTPUT_FORMAT
                      'Cấu trúc file Word (5-8 trang A4):

         [TRANG 1 - THÔNG TIN CHUNG]
         Tên trường…
         Tổ Toán…
         GIÁO ÁN DẠY HỌC – Toán 10…

         I. Mục tiêu: Kiến thức – Năng lực – Phẩm chất
         II. Thiết bị dạy học
         III. Tiến trình dạy học (4 hoạt động)
         - Hoạt động 1: Mở đầu
         - Hoạt động 2: Khám phá kiến thức mới
         - Hoạt động 3: Luyện tập
         - Hoạt động 4: Vận dụng/Củng cố

         IV. Đánh giá
         V. Phụ lục (Phiếu học tập, bài tập về nhà, tài liệu tham khảo…)

         Mỗi hoạt động có:
         a) Mục tiêu
         b) Nội dung
         c) Sản phẩm
         d) Tổ chức thực hiện (4 bước)',

                      -- CONSTRAINTS
                      'A. Cấu trúc bắt buộc (Công văn 5512):
         3 phần chính: Mục tiêu – Thiết bị – Tiến trình.
         4 hoạt động: Mở đầu – Khám phá – Luyện tập – Vận dụng.

         B. Yêu cầu nội dung:
         - HS tự viết ≥70% định nghĩa
         - GV không giảng quá 5 phút liên tục
         - Mỗi hoạt động có sản phẩm

         C. Câu hỏi khám phá (6-10 câu dẫn dắt)
         D. Bài tập phân 4 mức độ
         E. Phân hóa học sinh
         F. Đánh giá theo rubric 4 mức
         G. Định dạng Word chuyên nghiệp (5-8 trang)
         H. Checklist bắt buộc
         I. Điều cấm: Không sản phẩm, không phân hóa, thiếu rubric…',

                      'PUBLIC',
                      NULL
                  ),

         (
                      gen_random_uuid(), NULL, '00000000-0000-0000-0000-000000000001', NULL,
                      'Bộ tiêu chí chấm điểm (Rubric) chuẩn cho mọi bài kiểm tra Toán 10',
                      'Prompt tạo bộ RUBRIC hoàn chỉnh, công bằng, đo lường được cho mọi dạng bài kiểm tra Toán 10 (trắc nghiệm, tự luận, thực hành khảo sát hàm số, dự án, bài tập lớn), chuẩn Công văn 5512 & định hướng đánh giá năng lực THPT Quốc gia 2025+.',

                      -- INSTRUCTION
                      'Bạn là chuyên gia đánh giá năng lực Toán học THPT, thành viên ban ra đề & chấm thi THPT Quốc gia, trưởng ban chấm thi học sinh giỏi quốc gia.

         Nhiệm vụ: Tạo 1 bộ RUBRIC duy nhất áp dụng được cho toàn bộ các dạng kiểm tra Toán 10 trong cả năm học:
         - Kiểm tra 15 phút, 1 tiết
         - Kiểm tra học kỳ (trắc nghiệm + tự luận)
         - Bài tập lớn / dự án (khảo sát hàm số, bài toán thực tiễn, nghiên cứu nhỏ)
         - Thuyết trình sản phẩm nhóm
         - Portfolio bài tập nâng cao

         Yêu cầu bắt buộc:
         - Chia đúng 4 mức độ theo CT 2018: Mức 1 (4–5đ), Mức 2 (6–7đ), Mức 3 (8–9đ), Mức 4 (9.5–10đ)
         - Mỗi rubric có 4–6 tiêu chí con rõ ràng, định lượng được (đúng phương pháp, trình bày, sáng tạo, tính chính xác, vận dụng thực tiễn…)
         - Mô tả hành vi học sinh cụ thể ở từng mức, giáo viên khác chấm cùng bài không lệch quá 0.25 điểm
         - Có rubric riêng cho: trắc nghiệm 50 câu, tự luận đại số, tự luận hình học, khảo sát hàm số bằng GeoGebra, bài toán thực tiễn, dự án nhóm, thuyết trình
         - Tổng cộng ≥15 rubric mẫu trong 1 file Word duy nhất
         - Định dạng đẹp, bảng rõ ràng, dễ in, dễ dán vào giáo án hoặc bảng chấm',

                      -- CONTEXT
                      'Các dạng kiểm tra Toán 10 cần rubric:
         1. Trắc nghiệm khách quan 50 câu (THPT Quốc gia)
         2. Tự luận đại số & giải tích (hàm số, đạo hàm, lượng giác…)
         3. Tự luận hình học phẳng (vectơ, đường tròn, tứ giác…)
         4. Bài khảo sát hàm số + vẽ đồ thị bằng GeoGebra/Desmos
         5. Bài toán thực tiễn (tối ưu, tài chính, vật lý…)
         6. Dự án nhóm (nghiên cứu một bài toán thực tế)
         7. Thuyết trình sản phẩm toán học
         8. Bài tập lớn cuối chương (có phần mở rộng)
         9. Portfolio học tập cả năm

         Nguyên tắc: Đánh giá cả kiến thức – kỹ năng – tư duy – sáng tạo – thái độ',

                      -- INPUT_EXAMPLE
                      'lop: "10"
         mon: "Toán học"
         nam_hoc: "2025-2026"
         yeu_cau_tuy_chinh:
           - "Có rubric riêng cho bài tự luận hình học chứng minh"
           - "Có rubric cho bài khảo sát hàm số bậc ba, bậc bốn"
           - "Có rubric cho bài toán thực tiễn vận dụng đạo hàm"
           - "Có rubric cho dự án nhóm “Ứng dụng toán học trong đời sống”"
           - "Có phiên bản rút gọn in A4 dán bàn chấm thi"',

                      -- OUTPUT_FORMAT
                      'Cấu trúc file Word duy nhất (25–35 trang):

         TRANG BÌA + HƯỚNG DẪN SỬ DỤNG BỘ RUBRIC TOÁN 10

         I. Nguyên tắc chung xây dựng rubric Toán 10
         II. 15+ bảng rubric chi tiết:
            1. Rubric trắc nghiệm khách quan 50 câu
            2. Rubric tự luận đại số & giải tích (bài 4–6 điểm)
            3. Rubric tự luận hình học chứng minh
            4. Rubric khảo sát hàm số (có bảng biến thiên + đồ thị)
            5. Rubric bài toán thực tiễn (đặt ẩn, lập hàm, kết luận)
            6. Rubric bài toán lượng giác nâng cao
            7. Rubric bài vectơ & ứng dụng hình học
            8. Rubric bài toán bất đẳng thức & cực trị
            9. Rubric GeoGebra/Desmos (đồ thị + file nộp)
            10. Rubric dự án nhóm Toán học thực tiễn
            11. Rubric thuyết trình sản phẩm toán học
            12. Rubric bài tập lớn cuối chương
            13. Rubric portfolio học tập cả năm
            14. Rubric kiểm tra 15 phút (2–3 câu tự luận)
            15. Rubric tổng hợp (kết hợp trắc nghiệm + tự luận)

         Mỗi bảng có:
         - Tiêu chí | Mức 1 | Mức 2 | Mức 3 | Mức 4 | Điểm tối đa
         - Dòng cuối: Tổng điểm + chỗ ghi nhận xét

         III. Phụ lục:
            - File Excel tính điểm tự động từ rubric
            - Biểu mẫu chấm thi học kỳ
            - Checklist lỗi trình bày thường gặp',

                      -- CONSTRAINTS
                      '- Mô tả hành vi cụ thể, không dùng từ chung chung như “tốt”, “khá tốt”
         - Tổng điểm mỗi rubric = 10.0 (hoặc 10 × số câu)
         - Giáo viên khác chấm cùng bài không lệch quá 0.25 điểm
         - Bảng có màu nhẹ, dễ photo đen trắng
         - Có hướng dẫn cách cộng điểm khi dùng nhiều rubric trong 1 bài thi
         - Bắt buộc kèm file .docx + .pdf + .xlsx tính điểm tự động',

                      'PUBLIC',
                      NULL
                  )
             RETURNING id
     )

-- GẮN TAG: grade:10 và subject:Toán học
INSERT INTO prompt_tags (prompt_id, tag_id, created_at)
SELECT p.id, g.id, now()
FROM inserted_prompts p, grade_tag g
UNION ALL
SELECT p.id, s.id, now()
FROM inserted_prompts p, subject_tag s;